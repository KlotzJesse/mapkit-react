{"version":3,"file":"Polyline.stories-f4fca924.js","sources":["../../src/components/Polyline.tsx"],"sourcesContent":["import { useContext, useEffect, useState } from 'react';\nimport MapContext from '../context/MapContext';\nimport PolylineProps from './PolylineProps';\n\nexport default function Polyline({\n  points,\n\n  visible = true,\n  enabled = true,\n  selected = false,\n\n  onSelect = undefined,\n  onDeselect = undefined,\n\n  lineCap = 'round',\n  lineDash = [],\n  lineDashOffset = 0,\n  lineJoin = 'round',\n  lineWidth = 1,\n\n  strokeColor = 'rgb(0, 122, 255)',\n  strokeOpacity = 1,\n  strokeStart = 0,\n  strokeEnd = 1,\n}: PolylineProps) {\n  const [polyline, setPolyline] = useState<mapkit.PolylineOverlay | null>(null);\n  const map = useContext(MapContext);\n\n  useEffect(() => {\n    if (map === null) return undefined;\n\n    const overlay = new mapkit.PolylineOverlay([]);\n    map.addOverlay(overlay);\n    setPolyline(overlay);\n\n    return () => {\n      map.removeOverlay(overlay);\n    };\n  }, [map]);\n\n  // Points\n  useEffect(() => {\n    if (polyline === null) return;\n    polyline.points = points\n      .map(({ latitude, longitude }) => new mapkit.Coordinate(latitude, longitude));\n  }, [polyline, points]);\n\n  // Simple properties\n  const properties = { visible, enabled, selected };\n  Object.entries(properties).forEach(([propertyName, prop]) => {\n    useEffect(() => {\n      if (!polyline) return;\n      // @ts-ignore\n      polyline[propertyName] = prop;\n    }, [polyline, prop]);\n  });\n\n  // Simple style properties\n  const styleProperties = {\n    lineCap,\n    lineDash,\n    lineDashOffset,\n    lineJoin,\n    lineWidth,\n\n    strokeColor,\n    strokeOpacity,\n    strokeStart,\n    strokeEnd,\n  };\n  Object.entries(styleProperties).forEach(([propertyName, prop]) => {\n    useEffect(() => {\n      if (!polyline) return;\n      // @ts-ignore\n      polyline.style[propertyName] = prop;\n    }, [polyline, prop]);\n  });\n\n  // Events\n  const events = [\n    { name: 'select', handler: onSelect },\n    { name: 'deselect', handler: onDeselect },\n  ] as const;\n  events.forEach(({ name, handler }) => {\n    useEffect(() => {\n      if (!polyline || !handler) return undefined;\n\n      const handlerWithoutParameters = () => handler();\n\n      polyline.addEventListener(name, handlerWithoutParameters);\n      return () => polyline.removeEventListener(name, handlerWithoutParameters);\n    }, [polyline, handler]);\n  });\n\n  return null;\n}\n"],"names":["Polyline","points","visible","enabled","selected","onSelect","onDeselect","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","strokeColor","strokeOpacity","strokeStart","strokeEnd","polyline","setPolyline","useState","map","useContext","MapContext","useEffect","overlay","latitude","longitude","propertyName","prop","name","handler","handlerWithoutParameters"],"mappings":"gVAIA,SAAAA,EAAA,CAAiC,OAAAC,EAC/B,QAAAC,EAAA,GAEU,QAAAC,EAAA,GACA,SAAAC,EAAA,GACC,SAAAC,EAAA,OAEA,WAAAC,EAAA,OACE,QAAAC,EAAA,QAEH,SAAAC,EAAA,CAAA,EACE,eAAAC,EAAA,EACK,SAAAC,EAAA,QACN,UAAAC,EAAA,EACC,YAAAC,EAAA,mBAEE,cAAAC,EAAA,EACE,YAAAC,EAAA,EACF,UAAAC,EAAA,CAEhB,EAAA,CACE,KAAA,CAAAC,EAAAC,CAAA,EAAAC,EAAA,SAAA,IAAA,EACAC,EAAAC,aAAAC,CAAA,EAEAC,OAAAA,EAAAA,UAAA,IAAA,CACE,GAAAH,IAAA,KAAkB,OAElB,MAAAI,EAAA,IAAA,OAAA,gBAAA,CAAA,CAAA,EACA,OAAAJ,EAAA,WAAAI,CAAA,EACAN,EAAAM,CAAA,EAEA,IAAA,CACEJ,EAAA,cAAAI,CAAA,CAAyB,CAC3B,EAAA,CAAAJ,CAAA,CAAA,EAIFG,EAAAA,UAAA,IAAA,CACEN,IAAA,OACAA,EAAA,OAAAf,EAAA,IAAA,CAAA,CAAA,SAAAuB,EAAA,UAAAC,CAAA,IAAA,IAAA,OAAA,WAAAD,EAAAC,CAAA,CAAA,EAC8E,EAAA,CAAAT,EAAAf,CAAA,CAAA,EAKhF,OAAA,QADA,CAAA,QAAAC,EAAA,QAAAC,EAAA,SAAAC,CAAA,CACA,EAAA,QAAA,CAAA,CAAAsB,EAAAC,CAAA,IAAA,CACEL,EAAAA,UAAA,IAAA,CACEN,IAEAA,EAAAU,GAAAC,EAAyB,EAAA,CAAAX,EAAAW,CAAA,CAAA,CACR,CAAA,EAgBrB,OAAA,QAZA,CAAwB,QAAApB,EACtB,SAAAC,EACA,eAAAC,EACA,SAAAC,EACA,UAAAC,EACA,YAAAC,EAEA,cAAAC,EACA,YAAAC,EACA,UAAAC,CACA,CAEF,EAAA,QAAA,CAAA,CAAAW,EAAAC,CAAA,IAAA,CACEL,EAAAA,UAAA,IAAA,CACEN,IAEAA,EAAA,MAAAU,GAAAC,EAA+B,EAAA,CAAAX,EAAAW,CAAA,CAAA,CACd,CAAA,EAIrB,CAAe,CAAA,KAAA,SAAA,QAAAtB,CAAA,EACuB,CAAA,KAAA,WAAA,QAAAC,CAAA,CACI,EAE1C,QAAA,CAAA,CAAA,KAAAsB,EAAA,QAAAC,CAAA,IAAA,CACEP,EAAAA,UAAA,IAAA,CACE,GAAA,CAAAN,GAAA,CAAAa,EAA2B,OAE3B,MAAAC,EAAA,IAAAD,IAEA,OAAAb,EAAA,iBAAAY,EAAAE,CAAA,EACA,IAAAd,EAAA,oBAAAY,EAAAE,CAAA,CAAwE,EAAA,CAAAd,EAAAa,CAAA,CAAA,CACpD,CAAA,EAGxB,IACF;;;;;;;;;;;;;;;;;;;;;;;"}