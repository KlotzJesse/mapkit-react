{"version":3,"file":"Annotation-d9f4e275.js","sources":["../../src/components/Annotation.tsx"],"sourcesContent":["import {\n  useContext,\n  useEffect,\n  useState,\n  useMemo,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport MapContext from '../context/MapContext';\nimport AnnotationProps from './AnnotationProps';\n\nexport default function Annotation({\n  latitude,\n  longitude,\n\n  title = '',\n  subtitle = '',\n  accessibilityLabel = null,\n\n  selected = undefined,\n  onSelect = undefined,\n  onDeselect = undefined,\n  children,\n}: AnnotationProps) {\n  const [annotation, setAnnotation] = useState<mapkit.Annotation | null>(null);\n  const contentEl = useMemo<HTMLDivElement>(() => document.createElement('div'), []);\n  const map = useContext(MapContext);\n\n  // Coordinates\n  useEffect(() => {\n    if (map === null) return undefined;\n\n    const a = new mapkit.Annotation(\n      new mapkit.Coordinate(latitude, longitude),\n      () => contentEl,\n    );\n    map.addAnnotation(a);\n    setAnnotation(a);\n\n    return () => {\n      map.removeAnnotation(a);\n    };\n  }, [map, latitude, longitude]);\n\n  // Simple values properties\n  const properties = {\n    title,\n    subtitle,\n    accessibilityLabel,\n\n    selected,\n  };\n  Object.entries(properties).forEach(([propertyName, prop]) => {\n    useEffect(() => {\n      if (!annotation) return;\n      // @ts-ignore\n      annotation[propertyName] = prop;\n    }, [annotation, prop]);\n  });\n\n  // Events\n  const events = [\n    { name: 'select', handler: onSelect },\n    { name: 'deselect', handler: onDeselect },\n  ] as const;\n  events.forEach(({ name, handler }) => {\n    useEffect(() => {\n      if (!annotation || !handler) return undefined;\n\n      const handlerWithoutParameters = () => handler();\n\n      annotation.addEventListener(name, handlerWithoutParameters);\n      return () => annotation.removeEventListener(name, handlerWithoutParameters);\n    }, [annotation, handler]);\n  });\n\n  return createPortal(children, contentEl);\n}\n"],"names":["Annotation","latitude","longitude","title","subtitle","accessibilityLabel","selected","onSelect","onDeselect","children","annotation","setAnnotation","useState","contentEl","useMemo","map","useContext","MapContext","useEffect","a","propertyName","prop","name","handler","handlerWithoutParameters","createPortal"],"mappings":"sHAUA,SAAAA,EAAA,CAAmC,SAAAC,EACjC,UAAAC,EACA,MAAAC,EAAA,GAEQ,SAAAC,EAAA,GACG,mBAAAC,EAAA,KACU,SAAAC,EAAA,OAEV,SAAAC,EAAA,OACA,WAAAC,EAAA,OACE,SAAAC,CAEf,EAAA,CACE,KAAA,CAAAC,EAAAC,CAAA,EAAAC,EAAA,SAAA,IAAA,EACAC,EAAAC,EAAAA,QAAA,IAAA,SAAA,cAAA,KAAA,EAAA,CAAA,CAAA,EACAC,EAAAC,aAAAC,CAAA,EAGAC,OAAAA,EAAAA,UAAA,IAAA,CACE,GAAAH,IAAA,KAAkB,OAElB,MAAAI,EAAA,IAAA,OAAA,WAAqB,IAAA,OAAA,WAAAlB,EAAAC,CAAA,EACsB,IAAAW,CACnC,EAER,OAAAE,EAAA,cAAAI,CAAA,EACAR,EAAAQ,CAAA,EAEA,IAAA,CACEJ,EAAA,iBAAAI,CAAA,CAAsB,CACxB,EAAA,CAAAJ,EAAAd,EAAAC,CAAA,CAAA,EAWF,OAAA,QAPA,CAAmB,MAAAC,EACjB,SAAAC,EACA,mBAAAC,EACA,SAAAC,CAEA,CAEF,EAAA,QAAA,CAAA,CAAAc,EAAAC,CAAA,IAAA,CACEH,EAAAA,UAAA,IAAA,CACER,IAEAA,EAAAU,GAAAC,EAA2B,EAAA,CAAAX,EAAAW,CAAA,CAAA,CACR,CAAA,EAIvB,CAAe,CAAA,KAAA,SAAA,QAAAd,CAAA,EACuB,CAAA,KAAA,WAAA,QAAAC,CAAA,CACI,EAE1C,QAAA,CAAA,CAAA,KAAAc,EAAA,QAAAC,CAAA,IAAA,CACEL,EAAAA,UAAA,IAAA,CACE,GAAA,CAAAR,GAAA,CAAAa,EAA6B,OAE7B,MAAAC,EAAA,IAAAD,IAEA,OAAAb,EAAA,iBAAAY,EAAAE,CAAA,EACA,IAAAd,EAAA,oBAAAY,EAAAE,CAAA,CAA0E,EAAA,CAAAd,EAAAa,CAAA,CAAA,CACpD,CAAA,EAG1BE,EAAA,aAAAhB,EAAAI,CAAA,CACF;;;"}