{"version":3,"file":"Marker-4f50760f.js","sources":["../../src/components/Marker.tsx"],"sourcesContent":["import { useContext, useEffect, useState } from 'react';\nimport MapContext from '../context/MapContext';\nimport { FeatureVisibility, toMapKitFeatureVisibility } from '../util/parameters';\nimport MarkerProps from './MarkerProps';\nimport forwardMapkitEvent from '../util/forwardMapkitEvent';\n\nexport default function Marker({\n  latitude,\n  longitude,\n\n  title = '',\n  subtitle = '',\n  accessibilityLabel = null,\n  subtitleVisibility = FeatureVisibility.Adaptive,\n  titleVisibility = FeatureVisibility.Adaptive,\n  clusteringIdentifier = null,\n  color = '#ff5b40',\n  glyphColor = 'white',\n\n  glyphText = '',\n  glyphImage = null,\n  selectedGlyphImage = null,\n\n  paddingTop = 0,\n  paddingRight = 0,\n  paddingBottom = 0,\n  paddingLeft = 0,\n  anchorOffsetX = 0,\n  anchorOffsetY = 0,\n\n  selected = false,\n  animates = true,\n  appearanceAnimation = '',\n  visible = true,\n\n  draggable = false,\n  enabled = true,\n\n  onSelect = undefined,\n  onDeselect = undefined,\n  onDragStart = undefined,\n  onDragEnd = undefined,\n  onDragging = undefined,\n}: MarkerProps) {\n  const [marker, setMarker] = useState<mapkit.MarkerAnnotation | null>(null);\n  const map = useContext(MapContext);\n\n  // Coordinates\n  useEffect(() => {\n    if (map === null) return undefined;\n\n    const m = new mapkit.MarkerAnnotation(\n      new mapkit.Coordinate(latitude, longitude),\n    );\n    map.addAnnotation(m);\n    setMarker(m);\n\n    return () => {\n      map.removeAnnotation(m);\n    };\n  }, [map, latitude, longitude]);\n\n  // Enum properties\n  useEffect(() => {\n    if (!marker) return;\n    marker.subtitleVisibility = toMapKitFeatureVisibility(subtitleVisibility);\n  }, [marker, subtitleVisibility]);\n  useEffect(() => {\n    if (!marker) return;\n    marker.titleVisibility = toMapKitFeatureVisibility(titleVisibility);\n  }, [marker, titleVisibility]);\n\n  // Padding\n  useEffect(() => {\n    if (!marker) return;\n    marker.padding = new mapkit.Padding(paddingTop, paddingRight, paddingBottom, paddingLeft);\n  }, [marker, paddingTop, paddingRight, paddingBottom, paddingLeft]);\n\n  // AnchorOffset\n  useEffect(() => {\n    if (!marker) return;\n    marker.anchorOffset = new DOMPoint(anchorOffsetX, anchorOffsetY);\n  }, [marker, anchorOffsetX, anchorOffsetY]);\n\n  // Simple values properties\n  const properties = {\n    title,\n    subtitle,\n    accessibilityLabel,\n\n    color,\n    glyphColor,\n\n    glyphText,\n    glyphImage,\n    selectedGlyphImage,\n\n    clusteringIdentifier,\n    selected,\n    animates,\n    appearanceAnimation,\n    draggable,\n    enabled,\n    visible,\n  };\n  Object.entries(properties).forEach(([propertyName, prop]) => {\n    useEffect(() => {\n      if (!marker) return;\n      // @ts-ignore\n      if (prop === undefined) { delete marker[propertyName]; return; }\n      // @ts-ignore\n      marker[propertyName] = prop;\n    }, [marker, prop]);\n  });\n\n  // Events\n  const handlerWithoutParameters = () => { };\n  const events = [\n    { name: 'select', handler: onSelect },\n    { name: 'deselect', handler: onDeselect },\n    { name: 'drag-start', handler: onDragStart },\n  ] as const;\n  events.forEach(({ name, handler }) => {\n    forwardMapkitEvent(marker, name, handler, handlerWithoutParameters);\n  });\n\n  const dragEndParameters = () => ({\n    latitude: marker!.coordinate.latitude,\n    longitude: marker!.coordinate.longitude,\n  });\n  const draggingParameters = (e: { coordinate: mapkit.Coordinate }) => ({\n    latitude: e.coordinate.latitude,\n    longitude: e.coordinate.longitude,\n  });\n  forwardMapkitEvent(marker, 'drag-end', onDragEnd, dragEndParameters);\n  forwardMapkitEvent(marker, 'dragging', onDragging, draggingParameters);\n\n  return null;\n}\n"],"names":["Marker","latitude","longitude","title","subtitle","accessibilityLabel","subtitleVisibility","FeatureVisibility","titleVisibility","clusteringIdentifier","color","glyphColor","glyphText","glyphImage","selectedGlyphImage","paddingTop","paddingRight","paddingBottom","paddingLeft","anchorOffsetX","anchorOffsetY","selected","animates","appearanceAnimation","visible","draggable","enabled","onSelect","onDeselect","onDragStart","onDragEnd","onDragging","marker","setMarker","useState","map","useContext","MapContext","useEffect","m","toMapKitFeatureVisibility","propertyName","prop","handlerWithoutParameters","name","handler","forwardMapkitEvent","dragEndParameters","draggingParameters","e"],"mappings":"mGAMA,SAAAA,EAAA,CAA+B,SAAAC,EAC7B,UAAAC,EACA,MAAAC,EAAA,GAEQ,SAAAC,EAAA,GACG,mBAAAC,EAAA,KACU,mBAAAC,EAAAC,EAAA,SACkB,gBAAAC,EAAAD,EAAA,SACH,qBAAAE,EAAA,KACb,MAAAC,EAAA,UACf,WAAAC,EAAA,QACK,UAAAC,EAAA,GAED,WAAAC,EAAA,KACC,mBAAAC,EAAA,KACQ,WAAAC,EAAA,EAER,aAAAC,EAAA,EACE,cAAAC,EAAA,EACC,YAAAC,EAAA,EACF,cAAAC,EAAA,EACE,cAAAC,EAAA,EACA,SAAAC,EAAA,GAEL,SAAAC,EAAA,GACA,oBAAAC,EAAA,GACW,QAAAC,EAAA,GACZ,UAAAC,EAAA,GAEE,QAAAC,EAAA,GACF,SAAAC,EAAA,OAEC,WAAAC,EAAA,OACE,YAAAC,EAAA,OACC,UAAAC,EAAA,OACF,WAAAC,EAAA,MAEd,EAAA,CACE,KAAA,CAAAC,EAAAC,CAAA,EAAAC,EAAA,SAAA,IAAA,EACAC,EAAAC,aAAAC,CAAA,EAGAC,EAAAA,UAAA,IAAA,CACE,GAAAH,IAAA,KAAkB,OAElB,MAAAI,EAAA,IAAA,OAAA,iBAAqB,IAAA,OAAA,WAAAtC,EAAAC,CAAA,CACsB,EAE3C,OAAAiC,EAAA,cAAAI,CAAA,EACAN,EAAAM,CAAA,EAEA,IAAA,CACEJ,EAAA,iBAAAI,CAAA,CAAsB,CACxB,EAAA,CAAAJ,EAAAlC,EAAAC,CAAA,CAAA,EAIFoC,EAAAA,UAAA,IAAA,CACEN,IACAA,EAAA,mBAAAQ,EAAAlC,CAAA,EAAwE,EAAA,CAAA0B,EAAA1B,CAAA,CAAA,EAE1EgC,EAAAA,UAAA,IAAA,CACEN,IACAA,EAAA,gBAAAQ,EAAAhC,CAAA,EAAkE,EAAA,CAAAwB,EAAAxB,CAAA,CAAA,EAIpE8B,EAAAA,UAAA,IAAA,CACEN,IACAA,EAAA,QAAA,IAAA,OAAA,QAAAjB,EAAAC,EAAAC,EAAAC,CAAA,EAAwF,EAAA,CAAAc,EAAAjB,EAAAC,EAAAC,EAAAC,CAAA,CAAA,EAI1FoB,EAAAA,UAAA,IAAA,CACEN,IACAA,EAAA,aAAA,IAAA,SAAAb,EAAAC,CAAA,EAA+D,EAAA,CAAAY,EAAAb,EAAAC,CAAA,CAAA,EAwBjE,OAAA,QApBA,CAAmB,MAAAjB,EACjB,SAAAC,EACA,mBAAAC,EACA,MAAAK,EAEA,WAAAC,EACA,UAAAC,EAEA,WAAAC,EACA,mBAAAC,EACA,qBAAAL,EAEA,SAAAY,EACA,SAAAC,EACA,oBAAAC,EACA,UAAAE,EACA,QAAAC,EACA,QAAAF,CACA,CAEF,EAAA,QAAA,CAAA,CAAAiB,EAAAC,CAAA,IAAA,CACEJ,EAAAA,UAAA,IAAA,CACE,GAAAN,EAEA,IAAAU,IAAA,OAAA,CAA0B,OAAAV,EAAAS,GAA6B,MAAA,CAEvDT,EAAAS,GAAAC,EAAuB,EAAA,CAAAV,EAAAU,CAAA,CAAA,CACR,CAAA,EAInB,MAAAC,EAAA,IAAA,CAAuC,EACvC,CAAe,CAAA,KAAA,SAAA,QAAAhB,CAAA,EACuB,CAAA,KAAA,WAAA,QAAAC,CAAA,EACI,CAAA,KAAA,aAAA,QAAAC,CAAA,CACG,EAE7C,QAAA,CAAA,CAAA,KAAAe,EAAA,QAAAC,CAAA,IAAA,CACEC,EAAAd,EAAAY,EAAAC,EAAAF,CAAA,CAAkE,CAAA,EAGpE,MAAAI,EAAA,KAAA,CAAiC,SAAAf,EAAA,WAAA,SACF,UAAAA,EAAA,WAAA,SACC,GAEhCgB,EAAAC,IAAA,CAAsE,SAAAA,EAAA,WAAA,SAC7C,UAAAA,EAAA,WAAA,SACC,GAE1B,OAAAH,EAAAd,EAAA,WAAAF,EAAAiB,CAAA,EACAD,EAAAd,EAAA,WAAAD,EAAAiB,CAAA,EAEA,IACF;;;;;;;;;;;;;;;;;;;;;;;;"}